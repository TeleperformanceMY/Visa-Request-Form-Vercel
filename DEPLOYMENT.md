# Deployment Guide for Global Visa Requirements Tool

## Quick Start: Deploy to Vercel (1 minute)

### Option 1: Using the Vercel Dashboard

1. **Push your code to GitHub**
   \`\`\`bash
   git push origin main
   \`\`\`

2. **Import in Vercel**
   - Go to [vercel.com/new](https://vercel.com/new)
   - Select your GitHub repository
   - Click "Import"
   - Vercel auto-detects Next.js settings
   - Click "Deploy"

3. **Your app is live!** ðŸŽ‰

### Option 2: Using Vercel CLI

\`\`\`bash
# Install Vercel CLI globally
npm i -g vercel

# Deploy from your project directory
vercel

# For production deployment
vercel --prod
\`\`\`

## Optional: Add Redis Caching (Recommended for Production)

### With Upstash Redis

1. **Add Upstash Integration to Vercel**
   - In your Vercel project settings
   - Go to "Integrations" â†’ "Browse Marketplace"
   - Search for "Upstash"
   - Click "Add Integration"
   - Select your project and click "Add"
   - Vercel automatically sets environment variables: `KV_REST_API_URL` and `KV_REST_API_TOKEN`

2. **Redeploy**
   - Push a commit or redeploy from Vercel dashboard
   - Redis caching is now active!

The app works without Redis, but Redis enables:
- Better performance on high-traffic deployments
- Distributed caching across serverless functions
- 24-hour data persistence between deployments

## Deployment Checklist

- [ ] Code pushed to GitHub
- [ ] Vercel project created and connected
- [ ] Domain configured (optional)
- [ ] Analytics enabled in Vercel dashboard (optional)
- [ ] Custom domain SSL certificate (auto-managed by Vercel)
- [ ] Redis integration added (optional, recommended)

## Environment Variables

### Optional (for Redis caching)

When you add the Upstash Redis integration, these are automatically set:

- `KV_REST_API_URL` - Redis REST API URL
- `KV_REST_API_TOKEN` - Redis authentication token

**No configuration needed!** Vercel handles it all.

## Monitoring & Analytics

### Enable Vercel Analytics

1. Install Analytics SDK (already included):
   \`\`\`bash
   npm install @vercel/analytics
   \`\`\`

2. It's already imported in `app/layout.tsx`, so analytics are automatic!

3. View your analytics in [vercel.com/dashboard](https://vercel.com/dashboard)

### Monitor API Performance

In your Vercel project:
1. Go to "Analytics" tab
2. Check request latency and error rates
3. View top performing/slowest routes

## Custom Domain

1. **In Vercel Project Settings**
   - Go to "Domains"
   - Click "Add"
   - Enter your domain

2. **Update DNS Records** (if using external registrar)
   - Vercel provides the DNS records to add
   - Add them to your domain registrar

3. **SSL Certificate**
   - Automatically generated by Vercel
   - Renewed automatically

## Performance Optimization

The app is already optimized for Vercel:

- âœ… Image optimization (using Next.js Image component)
- âœ… Code splitting (automatic with Next.js)
- âœ… API route caching headers set
- âœ… Incremental Static Regeneration (ISR) ready
- âœ… Edge function compatible

### Further Optimization (Optional)

To add Edge Middleware for geolocation-based redirects:

\`\`\`typescript
// middleware.ts
import { NextRequest, NextResponse } from 'next/server'

export function middleware(request: NextRequest) {
  // Add any custom middleware logic here
  return NextResponse.next()
}

export const config = {
  matcher: [
    '/((?!_next/static|_next/image|favicon.ico).*)',
  ],
}
\`\`\`

## Troubleshooting

### Issue: Build fails

**Solution:**
- Check build logs in Vercel dashboard
- Ensure all environment variables are set
- Run locally: \`npm run build\`

### Issue: Visa data not loading

**Solution:**
- Check if external API (rough-sun-2523.fly.dev) is accessible
- Verify nationality spelling exactly
- Check Vercel Function logs for errors

### Issue: Slow response times

**Solution:**
- Enable Redis caching (see above)
- Check if external API is slow
- Review Vercel Analytics for bottlenecks

### Issue: Rate limiting on external API

**Solution:**
- This shouldn't happen with proper caching
- If it does, implement request batching or migrate to a different API

## Rollback

To revert to a previous deployment:

1. Go to Vercel Project â†’ Deployments
2. Find the deployment you want to rollback to
3. Click the three dots â†’ "Promote to Production"

## Advanced: Environment-Specific Deployments

### Preview Deployments

Every pull request automatically creates a preview deployment:
- Get a unique URL for testing
- Share with team members
- No impact on production

### Production Deployments

Merging to main (or your configured branch) deploys to production.

## Monitoring Health

### Uptime Monitoring

Use a free service like [uptimerobot.com](https://uptimerobot.com):

1. Sign up
2. Add your Vercel domain
3. Get alerts if it goes down

### Error Tracking

Integrate Sentry for production error tracking (optional):

\`\`\`bash
npm install @sentry/nextjs
\`\`\`

Then follow Sentry's Next.js setup guide.

## Cost Estimation

**Vercel (Free Tier):**
- âœ… Includes: 5 projects, serverless functions, 10GB bandwidth/month
- âœ… No credit card required to start
- ðŸ’¡ Upgrade to Pro ($20/month) for higher limits

**Upstash Redis (Free Tier):**
- âœ… Includes: 10,000 commands/day free
- ðŸ’¡ That's thousands of API requests with caching!

**Total Cost:** $0-20/month depending on traffic

## Need Help?

- **Vercel Docs**: [vercel.com/docs](https://vercel.com/docs)
- **Next.js Docs**: [nextjs.org](https://nextjs.org)
- **Upstash Docs**: [upstash.com/docs](https://upstash.com/docs)

---

**Your app is production-ready!** ðŸš€
